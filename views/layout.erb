<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Scout</title>

    <link rel="stylesheet" href="/css/html5-reset.css" />
    <link rel="stylesheet" href="/css/main.css" />
  
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="/favicon.ico">

    <script src="/js/jquery-1.7.1.min.js"></script>
    <script src="/js/jquery.pjax.js"></script>
    <script src="/js/jquery.placehold-0.3.min.js"></script>
    <script src="/js/h5f.min.js"></script>
    <script src="/js/main.js"></script>

    <script type="text/javascript">
        // client-side map of a user's interests and subscriptions, 
        // complete with delicious database IDs (will swap this with a slug or something later)
        var user_subscriptions = {};
        var interest;
        <% @interests.each do |interest, subscriptions| %>
          interest = encodeURIComponent("<%= js_escape interest.in %>");
          user_subscriptions[interest] = {
            interest_id: "<%= interest.id.to_s %>",
            subscriptions: {}
          };
          <% subscriptions.each do |subscription| %>
            user_subscriptions[interest].subscriptions.<%= subscription.subscription_type %> = '<%= subscription.id.to_s %>';
          <% end %>
        <% end %>
    </script>

</head>
<body>

    <div class="headerWrapper">
        <% if home? %>
        <div class="homeWrapper">
        <% end %>

        <header class="contentWrapper">
            <nav>
                <ul id="userNav">
                    <% if logged_in? %>
                        <li>
                            <%= current_user.email %>
                        </li>
                        <li class="subscriptions">
                            <a href="/account/subscriptions">
                                Subscriptions
                                <span class="count">(<%= @interests.size %>)</span>
                            </a>
                        </li>
                        <li class="settings">
                            <a href="/account/settings">Settings</a>
                        </li>
                        <li>
                            <a href="/logout">Log Out</a>
                        </li>
                    <% else %>
                        <li>
                            <a href="/login">Login or Sign up</a>
                        </li>
                    <% end %>
                </ul>
            </nav>
            
            <div class="clear"></div>
            
            <a href="/">
                <h1 class="textIndent">Scout</h1>
            </a>

            <% if home? %>
                <img class="splash" src="/images/splash.png" width="960" height="237" alt="Splash">
            <% end %>

            <% if search? %>
                <%= partial "search/search", :engine => "erb", :locals => {} %>
            <% end %>
            
            <div class="clear"></div>
        </header>

        <% if home? %>
        </div>
        <% end %>
    </div>

    <div class="contentWrapper" id="content">

        <% if title_area = yield_content(:title) %>
            <div class="pageTitle">
                <%= title_area %>
                <div class="clear"></div>
            </div>
        <% end %>

        <% if left_bar = yield_content(:sidebar_left) %>
            <div class="sidebar left">
                <%= left_bar %>
            </div>
        <% end %>

        <div id="center">
            <%= yield %>
        </div>

        <% if right_bar = yield_content(:sidebar_right) %>
            <div class="sidebar right">
                <%= right_bar %>
            </div>
        <% end %>
    </div>

    <div class="footerWrapper">
        <footer class="contentWrapper">
            <nav>
                <ul>
                    <li><a href="/about">About</a></li>
                    <li><a href="/contact">Contact</a></li>
                </ul>
            </nav>
            <div class="sunlightFoundation textIndent">
                Sunlight Foundation
            </div>
            <div class="aboutSF">
                <p>
                    Founded in 2006, the Sunlight Foundation is a non-partisan non-profit that uses cutting-edge technology and ideas to make government transparent and accountable.
                </p>
                <p>
                    Visit <a href="http://sunlightfoundation.com">SunlightFoundation.com</a> to learn more.
                </p>
            </div>
            <div class="clear"></div>
        </footer>
    </div>

    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-22821126-16']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>

    <script type="text/javascript" src="http://use.typekit.com/bsl1eko.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

</body>
</html>